branches:
  only:
    - travis-ci-sandbox

install:
  - sudo apt-get install tree
  - gem install asciidoctor
  - sudo pip install Pygments
  - sudo pip install -r scripts/requirements.txt
  - cd scripts
  - cd ..
  - rm -rf public || exit 0

script:
  - ./bin/hugo --buildFuture --verbose
  - cd public
  - touch .nojekyll
  - echo "redhatgov.rhtdemo.com" > CNAME
  - tree workshops
  - tree events
  - cd ..
  - pwd

deploy:
  provider: pages
  local-dir: public
  skip-cleanup: true
  github-token: $GITHUB_TOKEN
  target-branch: master
  verbose: true
  on:
    branch: travis-ci-sandbox
